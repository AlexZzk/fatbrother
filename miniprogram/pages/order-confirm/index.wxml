<nav-bar title="ç¡®è®¤è®¢å•" left-arrow="{{true}}" />

<view class="page-container">
  <block wx:if="{{merchant}}">
    <!-- å–é¤æ–¹å¼ -->
    <view class="section-card">
      <view class="section-title">å–é¤æ–¹å¼</view>
      <view class="pickup-row">
        <text class="pickup-icon">ğŸª</text>
        <text class="pickup-text">åˆ°åº—è‡ªå–</text>
      </view>
      <view class="pickup-address" wx:if="{{merchant.address}}">
        <text class="pickup-icon">ğŸ“</text>
        <text class="address-text">{{merchant.address}}</text>
      </view>
    </view>

    <!-- å•†å“æ¸…å• -->
    <view class="section-card">
      <view class="section-title">å•†å“æ¸…å•</view>
      <view class="product-row" wx:for="{{cartItems}}" wx:key="cartId">
        <view class="product-info">
          <text class="product-name">{{item.productName}}</text>
          <text class="product-spec" wx:if="{{item.specText}}"> ({{item.specText}})</text>
        </view>
        <view class="product-right">
          <text class="product-qty">x{{item.quantity}}</text>
          <view class="product-price">
            <price value="{{item.subtotal}}" />
          </view>
        </view>
      </view>
    </view>

    <!-- ä»·æ ¼æ˜ç»† -->
    <view class="section-card">
      <view class="section-title">ä»·æ ¼æ˜ç»†</view>
      <view class="price-row">
        <text class="price-label">å•†å“åˆè®¡</text>
        <view class="price-value"><price value="{{totalPrice}}" /></view>
      </view>
      <view class="price-row">
        <text class="price-label">åŒ…è£…è´¹</text>
        <view class="price-value"><price value="{{packingFee}}" /></view>
      </view>
      <view class="price-row">
        <text class="price-label">é…é€è´¹</text>
        <view class="price-value"><price value="{{deliveryFee}}" /></view>
      </view>
      <view class="price-divider"></view>
      <view class="price-row price-row--total">
        <text class="price-label">åˆè®¡</text>
        <view class="price-value price-value--total"><price value="{{actualPrice}}" /></view>
      </view>
    </view>

    <!-- å¤‡æ³¨ -->
    <view class="section-card">
      <view class="section-title">å¤‡æ³¨</view>
      <textarea
        class="remark-input"
        placeholder="é€‰å¡«ï¼Œå¦‚å£å‘³åå¥½ã€å–é¤æ—¶é—´ç­‰"
        maxlength="200"
        value="{{remark}}"
        bindinput="onRemarkInput"
      />
    </view>
  </block>
</view>

<!-- åº•éƒ¨æäº¤æ  -->
<view class="submit-bar" wx:if="{{merchant}}">
  <view class="submit-total">
    <text class="submit-label">åˆè®¡ </text>
    <view class="submit-price"><price value="{{actualPrice}}" /></view>
  </view>
  <view class="submit-btn {{submitting ? 'submit-btn--disabled' : ''}}" bindtap="onSubmit">
    {{submitting ? 'æäº¤ä¸­...' : 'æäº¤è®¢å•'}}
  </view>
</view>
