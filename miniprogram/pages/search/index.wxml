<!-- 搜索栏 (不使用 nav-bar，自定义搜索头部) -->
<view class="search-header">
  <view class="search-bar">
    <text class="search-icon">&#xe612;</text>
    <input
      class="search-input"
      placeholder="搜索商家、美食"
      value="{{keyword}}"
      focus="{{true}}"
      confirm-type="search"
      bindinput="onInput"
      bindconfirm="onConfirm"
    />
    <view class="search-clear" wx:if="{{keyword}}" bindtap="onClearInput">
      <text>×</text>
    </view>
  </view>
  <view class="search-cancel" bindtap="onCancel">
    <text>取消</text>
  </view>
</view>

<view class="page-container">
  <!-- 搜索历史（无搜索结果时显示） -->
  <block wx:if="{{!searched}}">
    <view class="history-section" wx:if="{{history.length}}">
      <view class="section-header">
        <text class="section-title">搜索历史</text>
        <text class="section-clear" bindtap="onClearHistory">清空</text>
      </view>
      <view class="history-tags">
        <view
          class="history-tag"
          wx:for="{{history}}"
          wx:key="*this"
          data-keyword="{{item}}"
          bindtap="onHistoryTap"
        >{{item}}</view>
      </view>
    </view>
  </block>

  <!-- 搜索结果 -->
  <block wx:if="{{searched}}">
    <!-- 加载中 -->
    <view wx:if="{{loading && results.length === 0}}" class="loading-center">
      <text>搜索中...</text>
    </view>

    <!-- 无结果 -->
    <empty-state
      wx:elif="{{!loading && results.length === 0}}"
      icon="search"
      text="未找到相关商家，换个关键词试试"
    />

    <!-- 结果列表 -->
    <view wx:else class="result-list">
      <shop-card
        wx:for="{{results}}"
        wx:key="_id"
        shop="{{item}}"
        bind:tap="onShopTap"
      />
      <view class="loading-more" wx:if="{{loading}}">
        <text>加载更多...</text>
      </view>
      <view class="no-more" wx:elif="{{!hasMore && results.length}}">
        <text>没有更多了</text>
      </view>
    </view>
  </block>
</view>
